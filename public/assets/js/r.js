/**
 * responsive.io v0.6.2
 * Copyright 2014, 14 Islands AB (14islands.com)
 */
!function(t,e,i){"use strict";function s(e,i,a){e.attachEvent?(e["e"+i+a]=a,e[i+a]=function(){e["e"+i+a](t.event)},e.attachEvent("on"+i,e[i+a])):e.addEventListener(i,a,!1)}function r(t,e,i){t.detachEvent?(t.detachEvent("on"+e,t[e+i]),t[e+i]=null):t.removeEventListener(e,i,!1)}function n(){i.debug&&t.console&&console.log("responsive.io",Array.prototype.slice.call(arguments))}function o(t,e){var i;t&&t.dispatchEvent&&document.createEvent&&(i=document.createEvent("HTMLEvents"),i.initEvent(e,!0,!1),t.dispatchEvent(i))}function l(t,e){var i=!1,a=!0,s=t.document,r=s.documentElement,n=s.addEventListener?"addEventListener":"attachEvent",o=s.addEventListener?"removeEventListener":"detachEvent",l=s.addEventListener?"":"on",h=function(a){("readystatechange"!=a.type||"complete"==s.readyState)&&(("load"==a.type?t:s)[o](l+a.type,h,!1),!i&&(i=!0)&&e.call(t,a.type||a))},d=function(){try{r.doScroll("left")}catch(t){return void setTimeout(d,50)}h("poll")};if("complete"==s.readyState)e.call(t,"lazy");else{if(s.createEventObject&&r.doScroll){try{a=!t.frameElement}catch(c){}a&&d()}s[n](l+"DOMContentLoaded",h,!1),s[n](l+"readystatechange",h,!1),t[n](l+"load",h,!1)}}function h(){var e=t.devicePixelRatio;return e?e:1}function d(t,e){var i=parseFloat(c(t,e));return isNaN(i)||0===i?!1:i}function c(t,e){return t.getPropertyValue(e)}function u(t,e){return t.getAttribute(e)}function p(t){var e;if(t)return 0===t.indexOf("http")?t:0===t.indexOf("//")?ee.protocol+t:0===t.indexOf("/")?ee.protocol+"//"+ee.host+t:(e=ee.pathname.slice(0,ee.pathname.lastIndexOf("/")),ee.protocol+"//"+ee.host+e+"/"+t)}function g(){return K++,Math.floor(K/D)%U}function f(t,e,a){var s,r,o=C,l="string"==typeof e._webp&&X?"false"!==e._webp:i.webp,d="string"==typeof e._r?"false"!==e._r:i.retina,c=h(),u=parseInt(e._q,10)?e._q:i.quality,p="",f="",m=-1;if(t.indexOf("://localhost")>-1&&n("WARN","responsive.io cannot load images from your localhost ("+t+")"),i.bypass)return t;if(i.onError&&"function"==typeof i.onError&&(s=t.indexOf("?")>-1?"&":"?",f+=s+"redirect_on_fail=false"),a){var v=a.match(/\/\/src(\d).responsive.io/);v&&v.length>1&&(m=v[1])}-1===m&&(m=g()),o=o.replace("[protocol]",ee.protocol),o=o.replace("[hostname]",Z),o=o.replace("[shard]",m),o=o.replace("[webp]",l?"webp/":""),o=o.replace("[query]",f),d&&c>1&&(e.pr=c),parseInt(u,10)<100&&(e.q=u);for(r in e)e.hasOwnProperty(r)&&0!==r.indexOf("_")&&(p+=e[r]?r+"="+e[r]+"/":"");return o=o.replace("[opts]",p),o=o.replace("[url]",t),encodeURI(o)}function m(t,e,a){t.el.setAttribute("data-rio-width",e),t.removeDataSrc(),t.isLoaded=!0,i.debug&&(te[u(t.el,"data-test-id")]=a)}function v(t){return i.bypass?!1:t.hasAttribute("data-rio-img")||t.hasAttribute("data-rio-bg")}function w(t){this._init(t)}function y(t,e){this.scale=1,this.width=null,this.pos=null,this.x=null,this.y=null,this.baseFocus=e,t&&this.parseString(t)}function b(t,e,i){this.interpolateOn=i,this.baseFocus=e,this.zoomLevels=[],this.parseString(t)}function z(t){this._init(t)}function A(t){var a,s=t||e.querySelectorAll("img[data-rio-img]"),r=s.length,o=0,l=!0;if(!i.bypass)for(n("Resizing",s.length,"images",s),o;r>o;o++)a=new w(s[o]),a.isResizedSmaller()?n("resize was smaller, dont fetch new",a):(a.calculateFinalWidth(l),n("detected resized image size",a.width),a.width<=parseInt(a.oldWidth,10)?n("resize was same, dont fetch new",a):a.load())}function S(t){var a,s,r=t||e.querySelectorAll("img[data-src]"),o=r.length,l=0;for(n("Found",r.length,"new images",r),l;o>l;l++)s=new w(r[l]),i.bypass?(s.load(),n("INFO","ResponsiveIO in bypass mode")):(a=s.originUrl,s.isValid()?(s.calculateFinalWidth(),n("detected image size",s.width),s.load()):n("WARN","empty data-src - ignoring",s.el))}function L(t){var i=t||e.querySelectorAll("[data-bg-src]"),a=i.length,s=0;for(n("Found",i.length,"new background images",i),s;a>s;s++)new z(i[s]).load()}function E(t){var i=t||e.querySelectorAll("[data-rio-bg]"),a=i.length,s=0;for(n("Resizing",i.length,"background images",i),s;a>s;s++)new z(i[s]).load()}function x(e,i){Y[e]=i+"",t.name=Y.join(",")}function W(t){return Y[t]}function F(){return Y=t.name?t.name.split(","):[],W(T)===N}function I(){var t=e.querySelectorAll("[data-rio-bg]"),i=t.length,a=0;for(a;i>a;a++)new z(t[a]).onResizeStart()}function P(){A(),E()}function O(){S(),L()}function B(){P(),O()}function R(t,e,i){v(t)?i([t]):e([t])}function q(t){t?("object"==typeof t&&t.length&&(t=t[0]),"IMG"===t.nodeName?R(t,S,A):R(t,L,E)):B()}function _(t){i.debug=t.debug||!1,i.onError=t.onError||null,i.bypass=J?!0:t.bypass||!1,i.webp="undefined"!=typeof t.webp?t.webp:!0,i.retina="undefined"!=typeof t.retina?t.retina:!0,i.quality=i.quality||100,i.debug&&(i.images=te)}function k(t){if(F())t("true"===W(j));else{x(T,N);var e=new Image;e.onload=e.onerror=function(){var i=2===e.height;x(j,i),t(i)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}}function M(){return _(i),i.refresh=q,k(function(e){X=e,e||(i.webp=!1),l(t,O)}),s(t,"resize",ie(P,Q)),s(t,"resize",ie(I,Q,!0)),i}var N="responsive.io",U=4,D=4,Z="src[shard].responsive.io",C="[protocol]//[hostname]/[webp][opts][url][query]",T=0,j=1,Q=500,V=50,$="320px 120%, 767px 100%",G=10,H=t.getComputedStyle,J="undefined"==typeof H,X=!1,Y=[],K=0,te={},ee=t.location;"undefined"==typeof e.querySelectorAll&&!function(t){t=e,a=t.styleSheets[0]||t.createStyleSheet(),t.querySelectorAll=function(e){a.addRule(e,"f:b");for(var i=t.all,s=0,r=[],n=i.length;n>s;s++)i[s].currentStyle.f&&r.push(i[s]);return a.removeRule(0),r}}(),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var ie=function(t,e,i){var a;return function(){function s(){i||t.apply(r,n),a=null}var r=this,n=arguments;a?clearTimeout(a):i&&t.apply(r,n),a=setTimeout(s,e||100)}};w.prototype={_init:function(t){this.el=t,this.dataSrc=u(this.el,"data-src"),this.dataRetina=u(this.el,"data-retina"),this.dataQuality=u(this.el,"data-quality"),this.dataWEBP=u(this.el,"data-webp"),this.imgAlt=u(this.el,"alt"),this.isLoaded=v(this.el),this.isLoaded&&(this.src=u(this.el,"src"),this.dataSrc||(this.dataSrc=u(this.el,"data-rio-img"))),this.imgAlt&&!this.isLoaded&&(this.imgOriginalDisplay=this.el.style.display,this.el.style.display="none",this.el.removeAttribute("alt"),this.el.offsetWidth,this.el.style.display=this.imgOriginalDisplay),this.originUrl=p(this.dataSrc),this.updateInitialWidth()},updateInitialWidth:function(){return this.width=this.el.offsetWidth,this.oldWidth=u(this.el,"data-rio-width"),this},isValid:function(){return this.originUrl&&this.originUrl.trim().length>0},isResizedSmaller:function(){return"false"===this.oldWidth?!0:(this.oldWidth=parseFloat(this.oldWidth),isFinite(this.oldWidth)?this.width<this.oldWidth:!1)},load:function(){function t(){r(h.el,"load",t),h.el.style.visibility=""}function e(){r(h.el,"error",e),"function"==typeof i.onError?(h.el.setAttribute("data-src",h.dataSrc),i.onError(h.el),n("img load error - using custom callback")):(o||(h.el.style.visibility="hidden"),s(h.el,"load",t),h.el.setAttribute("src",h.dataSrc),n("img load error - reverting to origin src")),i.debug&&(te[u(h.el,"data-test-id")].error=!0)}var a,o=!1;a={w:this.width,_q:this.dataQuality,_r:this.dataRetina,_webp:this.dataWEBP};var l=f(this.originUrl,a,this.src),h=this;if(h.isLoaded){o=!0;var d=new Image;d.onload=function(){h.el.setAttribute("src",l)},d.onerror=e,d.src=l}else i.bypass||s(h.el,"error",e),h.el.setAttribute("src",l);this.imgAlt&&this.el.setAttribute("alt",this.imgAlt),m(this,this.width,a)},getParentDimensions:function(t,e){var i=t.parentNode,a=H(i,null),s=d(a,"padding-left"),r=d(a,"padding-right"),n={width:Math.max(0,i.clientWidth-Math.ceil(s+r))},o=e?Math.max(e,V):V;if(n.width<=o&&i.parentNode){var l=this.getParentDimensions(i,s+r),h=d(a,"margin-left"),c=d(a,"margin-right");return l.width=l.width-s-r-h-c,l}return n},widthoutBordersAndPadding:function(t,e,i){var a=d(e,"border-left-width")+d(e,"border-right-width"),s=d(e,"padding-left")+d(e,"padding-right");if(a>0||s>0){var r=c(e,"box-sizing")||c(e,"-webkit-box-sizing")||c(e,"-moz-box-sizing");if("border-box"===r||i)return t-a-s}return t},getWidthBasedOnParent:function(t,e,i){var a=this.getParentDimensions(this.el),s=this.width;if(e.indexOf("px")>-1)s=a.width<i?a.width:i,s=this.widthoutBordersAndPadding(s,t);else if(e.indexOf("%")>-1){var r=Math.round(a.width*i*.01);s=this.widthoutBordersAndPadding(r,t)}else s&&(s=this.widthoutBordersAndPadding(s,t,!0));return s},calculateFinalWidth:function(t){var e=H(this.el,null),i=c(e,"max-width"),a=d(e,"max-width");!this.isLoaded&&this.widthoutBordersAndPadding(this.width,e,!0)<V&&(this.width=!1),this.width=!this.width&&c(e,"width").indexOf("%")>-1?this.getWidthBasedOnParent(e,c(e,"width"),d(e,"width")):!this.width||t?this.getWidthBasedOnParent(e,i,a):this.widthoutBordersAndPadding(this.width,e,!0),i.indexOf("px")>-1&&a<this.width&&(this.width=this.widthoutBordersAndPadding(a,e,!0)),this.width&&(this.width=Math.ceil(this.width))},removeDataSrc:function(){this.el.removeAttribute("data-src"),this.el.setAttribute("data-rio-img",this.dataSrc),i.bypass&&(this.el.className=this.el.className)}},y.prototype={roundPercentage:function(t){return t.match(/\d+%$/)?Math.round(parseFloat(t))+"%":t},compareTo:function(t){return this.width<t.width?-1:1},parseFocus:function(t){t||(t="50% 50%");var e=t.trim().split(/\s+/);if(e.length<2&&e.push("50%"),e[0].match(/top/i)||e[0].match(/bottom/i)||e[1].match(/left/i)||e[1].match(/right/i)){var i=e[0];e[0]=e[1],e[1]=i}return e[0]=this.roundPercentage(e[0]),e[1]=this.roundPercentage(e[1]),t=e.join(" ").replace(/top/gi,"0%").replace(/left/gi,"0%").replace(/center/gi,"50%").replace(/right/gi,"100%").replace(/bottom/gi,"100%"),e=t.split(" "),{pos:t,x:e[0],y:e[1]}},setFocus:function(t){var e=this.parseFocus(t);this.pos=e.pos,this.x=e.x,this.y=e.y},setScale:function(t){var e;e="string"==typeof t&&t.match(/\d+%$/)?parseFloat(t):100*t,this.scale=Math.round(e)/100},setWidth:function(t){this.width=parseFloat(t)},parseString:function(t){var e=t.trim().split(/\s+/);this.setWidth(e[0]),this.setScale(e[1]);var i=2,a=e.length,s="";for(i;a>i;i++)s+=e[i]+" ";this.setFocus(s||this.baseFocus)}},b.prototype={interpolate:function(t,e,i){var a=parseFloat(e)-parseFloat(t);return parseFloat(t)+i*a},interpolateZoom:function(t,e,i){var a=Math.min(1,Math.max(0,(i-t.width)/(e.width-t.width))),s=this.interpolate(t.scale,e.scale,a),r=this.interpolate(t.x,e.x,a)+"%",n=this.interpolate(t.y,e.y,a)+"%",o=r+" "+n,l=new y;return l.setWidth(i),l.setScale(s),l.setFocus(o),l},getActiveZoomLevel:function(t){if(this.zoomLevels&&this.zoomLevels.length)for(var e=0;e<this.zoomLevels.length;e++)if(t<=this.zoomLevels[e].width)return this.interpolateOn&&this.zoomLevels.length>=2&&e>0?this.interpolateZoom(this.zoomLevels[e],this.zoomLevels[e-1],t):this.zoomLevels[e];var i=new y;return i.setWidth(t),i.setFocus(this.baseFocus),i},parseString:function(t){if(null!==t){0===t.trim().length&&(t=$);var e=t.split(","),i=e.length,a=0;for(a;i>a;a++)this.zoomLevels.push(new y(e[a],this.baseFocus));this.zoomLevels.sort(function(t,e){return t.compareTo(e)})}}},z.prototype={_init:function(t){this.el=t,this.dataSrc=u(this.el,"data-bg-src"),this.dataFocus=u(this.el,"data-crop-focus"),this.dataZoom=u(this.el,"data-zoom"),this.dataInterpolate=u(this.el,"data-zoom-interpolate"),this.dataRetina=u(this.el,"data-retina"),this.dataQuality=u(this.el,"data-quality"),this.dataWEBP=u(this.el,"data-webp"),this.isLoaded=v(this.el),this.isLoaded&&(this.src=this.el.style.backgroundImage.slice(4,-1),this.dataSrc||(this.dataSrc=u(this.el,"data-rio-bg"))),this.originUrl=p(this.dataSrc),this.interpolateZoom=!(this.dataInterpolate&&"false"===this.dataInterpolate),this.zoomList=new b(this.dataZoom,this.dataFocus,this.interpolateZoom)},setBg:function(t,e,a,s){if(t!==this.src&&(this.el.style.backgroundImage="url("+t+")"),this.el.style.backgroundPosition=this.size.zoom.pos,this.el.style.backgroundRepeat="no-repeat",i.bypass||s)if(this.size.zoom&&this.size.zoom.scale>1&&e>-1&&a>-1){var r=e/a,n=this.size.width/this.size.height,o=Math.max(1,r/n);this.el.style.backgroundSize=100*this.size.zoom.scale*o+"%"}else this.el.style.backgroundSize="cover";else this.el.style.backgroundSize=e<this.size.width||a<this.size.height?"cover":this.size.width+"px"},calculateSize:function(){var t=this.el.clientWidth;if(J)t+=1;else{var e=H(this.el,null),i=d(e,"width");i%1>0&&.5>i%1&&(t+=1)}var a=Math.ceil(t/G)*G,s=Math.round(a*(this.el.clientHeight/this.el.clientWidth));return{width:a,height:s,zoom:this.zoomList.getActiveZoomLevel(t)}},load:function(){function t(){if("function"==typeof i.onError)a.el.setAttribute("data-bg-src",a.dataSrc),i.onError(a.el),n("bg img load error - using custom callback");else{var t=new Image;t.onload=function(){a.setBg(a.dataSrc,t.width,t.height,!0),o(a.el,"load")},t.onerror=function(){o(a.el,"error")},t.src=a.dataSrc,a.setBg(a.dataSrc,-1,-1,!0),n("bg load error - reverting to origin src")}}var e,a=this;a.size=a.calculateSize();var s={w:a.size.width,h:a.size.height,zoom:a.size.zoom.scale,focus:a.size.zoom.pos.replace(" ",","),_q:this.dataQuality,_r:a.dataRetina,_webp:this.dataWEBP};if(e=f(a.originUrl,s,a.src),a.src===e)return n("new bg image same as loaded - ignore load");var r=new Image;return r.onload=function(){a.setBg(e,r.width,r.height),o(a.el,"load")},r.onerror=t,r.src=e,a.isLoaded||a.setBg(e),m(a,a.size.width,s),this},onResizeStart:function(){i.bypass||(this.el.style.backgroundSize="cover")},removeDataSrc:function(){this.el.removeAttribute("data-bg-src"),this.el.setAttribute("data-rio-bg",this.dataSrc),i.bypass&&(this.el.className=this.el.className)}},t.ResponsiveIO=M()}(window,document,window.ResponsiveIO||{});